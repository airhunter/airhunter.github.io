---
title: "为抗义33号法令及其它相关“解释”、“管理办法”等，现停止更新BLOG(明天开始）"
date: 2005-03-23T14:31:00Z
tags: ["编程", "杂记"]
---

为抗义33号法令及其它相关“解释”、“管理办法”等，现停止更新BLOG，特此通告

最后一篇问个问题，知道一定要告诉我

我现在想编程实现把选定的文件转成PostScript文件。我已经安装了Adobe PostScript Driver，如果在打印时选择“打印到文件”或在打印机设置里端口配置里指定至FILE，然后打开DOC文档，或其它什么文档，打印，那么可以输出PostScript文件。（.ps或.prn文件）

但我我这样写，好像结果只是把文件复制了一回（好像,反正不是PostScript文件的）。
```cpp
AnsiString prtStr = "Generic PostScript Printer";
ADDJOB_INFO_1 *info;
BYTE data[1000];
info = (ADDJOB_INFO_1 *)data;
DWORD SizeNeeded;
HANDLE hPrinter;
OpenPrinter(prtStr.c_str(),&hPrinter,NULL);
AddJob(hPrinter,1,data,sizeof(data),&SizeNeeded;);
CopyFile("D:\\\TOPDF\\\PrintToFile\\\test.txt",info->Path,true);
ScheduleJob(hPrinter,info->JobId);
```
不过这段生成的就是PostScript文件
```cpp
TPrinter * pPrinter = Printer();
pPrinter->Title="打印Memo1中的数据";
pPrinter->BeginDoc();
int y=10;
for(int i=0;iLines->Count;i++)
{
pPrinter->Canvas->TextOut(10,y,Memo1->Lines->Strings[i]);
y+=pPrinter->Canvas->TextHeight("A");
}
pPrinter->EndDoc();
```
有什么办法可以编程实现选定文件自动打印输出PostScript文件么。 我的最终目的是把文档转成PDF格式，我在查CSDN的旧贴时发现GhostScript能把PostScript文件转成PDF，所以现在要解决如何生成PostScript文件。或大家有更好的方法生成PDF也可以告诉我，谢谢。
